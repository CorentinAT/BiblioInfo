<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Brume des Bois</title>
    <link rel="shortcut icon" href="./scr/Images/logo2.png" type="image/x-icon">
    <link rel="stylesheet" href="../css/page_document.css">
    <link rel="stylesheet" href="../css/all.css">

</head>

<header>
    <div class="header">
        <img src="../img/logo.png" alt="Logo" class="logo">
        <div>
            <button class="button">Accueil</button>
            <button class="button">Rechercher dans la bibliothèque</button>
            <button class="button">Ajouter un document</button>
        </div>
    </div>
</header>

<body>
    <div class="conteneur_gauche">
        <img id="couverture" src="" alt="" height="200" width="auto">
        <span>
            <img id="etoile_pleine" class="note" src="../img/etoile_pleine.png" alt="" />
            <img id="etoile_pleine" class="note" src="../img/etoile_pleine.png" alt="" />
            <img id="etoile_pleine" class="note" src="../img/etoile_pleine.png" alt="" />
            <img id="etoile_vide" class="note" src="../img/etoile_vide.png" alt="" />
            <img id="etoile_vide" class="note" src="../img/etoile_vide.png" alt="" />
        </span>
        <div class="vertical-line"></div>
    </div>

    <div class="conteneur_droit">
        <h1 id="titre"></h1>

        <div class="description">
            <div class="divAuteur">
                <h3>Auteur :</h3>
                <span id="auteur"></span>
            </div>
            <div class="divSynopsis">
                <h3><b>Synopsis :</b></h3>
                <span id="synopsis"></span>
            </div>
            <div class="divGenres">
                <h3>Genres :</h3>
                <span id="genres"></span>
            </div>
            <div class="divThemes">
                <h3>Thèmes :</h3>
                <span id="themes"></span>
            </div>
            <div class="divDispoLieu">
                <div class="dispo">
                    <img id="logoDispo" src="" alt="" height="20px" width="auto">
                    <span id="dispoTxt"></span>
                </div>
                <div class="lieu">
                    <div class="rayon">
                        <span>Rayon</span>
                        <span id="rayons"></span>
                    </div>
                    <div class="etage">
                        <span> Étage</span>
                        <span id="etage"></span>
                    </div>

                </div>
            </div>
            <div class="divNote">
                <button>Modifier</button>
                <button>Supprimer</button>
                <button>1</button>
                <button>2</button>
                <button>3</button>
                <button>4</button>
                <button>5</button>
                <button>Noter</button>
            </div>
        </div>
    </div>
</body>

<script>// Effectuer la requête AJAX
    var url = 'http://api.biblioinfo.live/document/11';
    var request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.onload = function () {
        window.addEventListener('DOMContentLoaded', function () {
            initialiserListe('http://api.biblioinfo.live/rayons', 'rayons', 'idrayon', 'nomrayon');
            initialiserListe('http://api.biblioinfo.live/genres', 'genres', 'idgenre', 'nomgenre');
            initialiserListe('http://api.biblioinfo.live/themes', 'themes', 'idtheme', 'nomtheme');
        })
        if (request.status >= 200 && request.status < 400) {
            var response = JSON.parse(request.responseText);

            var idVal = response.id;
            var noteMoyenneVal = response.note_moyenne;

            titre = document.getElementById("titre");
            titre.textContent = response.titre;

            synopsis = document.getElementById("synopsis");
            synopsis.textContent = response.description;

            genre = document.getElementById("genres");
            var genreText = response.genres.map(function (genre) {
                return genre.nomgenre;
            }).join(", ");
            genre.textContent = genreText;

            auteur = document.getElementById("auteur");
            auteur.textContent = response.auteur;

            themes = document.getElementById("themes");
            var themesText = response.themes.map(function (theme) {
                return theme.nomtheme;
            }).join(", ");
            themes.textContent = themesText;

            disponible = document.getElementById("disponible");
            disponibleTxt = document.getElementById("dispoTxt");
            imageDispo = document.getElementById("logoDispo");
            if (response.disponible) {
                imageDispo.src = "../img/logo_dispo_true.PNG";
                disponibleTxt.textContent = "Disponible";
            }
            else {
                imageDispo.src = "../img/logo_dispo_false.jpg";
                disponibleTxt.textContent = "Indisponible";
            }

            rayons = document.getElementById("rayons");
            rayons.textContent = response.rayon.nomrayon;

            etage = document.getElementById("etage");
            etage.textContent = response.rayon.etage;

            couverture = document.getElementById("couverture");
            couverture.src = response.liencouverture;



            //console.log(idVal);
            //console.log(titreVal);
            //console.log(liencouvertureVal);
            //console.log(descriptionVal);
            //console.log(auteurVal);
            //console.log(disponibleVal);
            //console.log(rayonVal);
            //console.log(noteMoyenneVal);
            //console.log(themesVal);
            //console.log(genresVal);
        } else {
            // La requête a échoué
            console.error('Erreur lors de la requête. Statut:', request.status);
        }
    };
    request.onerror = function () {
        // Erreur lors de la requête
        console.error('Erreur lors de la requête.');
    };
    request.send();
</script>

<footer>
    <div>

    </div>
</footer>

</html>